<!DOCTYPE html>
<html lang="ja">
  <head>
    <title>[Crypto] RSA Encryption (オリジナル)</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  </head>
  <body>
    <div class="container">
  <div class="theme-showcase row col-lg-12 bg-light mt-lg-4 mb-4 p-5 rounded">
    <h1 class="mb-4">Q7. [Crypto] RSA Encryption (オリジナル)</h1>
    <p>サマーウォーズの主人公のように、<a href="https://ja.wikipedia.org/wiki/RSA%E6%9A%97%E5%8F%B7">RSA暗号</a>という暗号を解読してみましょう。</p>
<p>ヒント: うまくやれば<code>n</code>は簡単に素因数分解できます。</p>
<p>e: <code>65537</code></p>
<p>n: <code>27333589662576212843053358389657197383463179501070707817492435364637976576534097843141116537496954306186454399936751380240681840781922045409026469015348277610097818873525367014327971026216521913345913556507735988063595101344684720025971437221372478723530021184581725186307555404879468405404485679866980685749351009030765908649393499614360264401297739807437689183573675545634245419377568066115574344088687542965899575577090483060847183379891662789965086483529694317089384991248584877380990994334957828843113667931519371949912279834327081531216490310165274448017556805555440379496434676311739508377532909390233117536309</code></p>
<p>c: <code>23199900198636655739863003276115645447442269061547662038923090522341563301700800244517200095289980810020607328732352713757901730113214355160211351940796566291268263263321738537425528697218758895412679235393010709444044112423705210735465075052910944946105546594730604436283103383501718598740609170541901571113365285894995635287688488410566781198703336301009602860978793748055215218898160295591830292285051100883428827930111211165463614567002188016017678793246167285713309413845472781800377494846951658902170626559819945167175132971203923090355019455136617192334572328243406146228454605743395019902933668560405054971018</code></p>

  </div>
  <div id="alert-container"></div>
  <form onsubmit="return verify_flag();">
    <div class="input-group mb-3">
      <input type="text" class="form-control" placeholder="Flag" aria-label="Flag" aria-describedby="button-addon2" id="form-flag">
      <input type="submit" value="確認" class="btn btn-primary">
    </div>
  </form>
  <script>
  // Generate sha256 hash.
  async function sha256(str) {
    const buff = new Uint8Array([].map.call(str, (c) => c.charCodeAt(0))).buffer;
    const digest = await window.crypto.subtle.digest('SHA-256', buff);
    return [].map.call(new Uint8Array(digest), x => ('00' + x.toString(16)).slice(-2)).join('');
  }

  let container = document.getElementById('alert-container');
  function show_alert(type, message) {
    let alert_elem = document.createElement('div');
    alert_elem.classList.add("alert", "alert-" + type, "alert-dismissible", "fade", "show");
    alert_elem.setAttribute("role", "alert");
    alert_elem.innerHTML = message + '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>';
    container.append(alert_elem);
    window.setTimeout(() => {
      if(container.contains(alert_elem)) {
        new bootstrap.Alert(alert_elem).close();
      }
    }, 2000);
  }

  function verify_flag(){
    let flag = document.getElementById('form-flag').value;
    let alert_container = document.getElementById('alert-container');
    sha256(flag).then(result => {
      if(result == "52c6e80cd10257bebb1df65842f192b1fe0f37dbb3417130d3eda63072edd437") {
        show_alert('success', '正解!おめでとう!');
      } else {
        show_alert('danger', 'フラグが間違っています。');
      }
    });
    return false;
  }
  </script>
    </div>
  </body>
</html>
