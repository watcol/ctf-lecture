<!DOCTYPE html>
<html lang="ja">
  <head>
    <title>[Reversing] Hello, Binary! (オリジナル)</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  </head>
  <body>
    <div class="container">
  <div class="theme-showcase row col-lg-12 bg-light mt-lg-4 mb-4 p-5 rounded">
    <h1 class="mb-4">Q8. [Reversing] Hello, Binary! (オリジナル)</h1>
    <p>今度は、Linux用バイナリを解析(機械語を解読)してみましょう。</p>
<p>以下は、文字列をを入力したらそれが正しいフラグかどうか判別してくれるプログラムです。</p>
<p><a href="./bin">bin</a></p>

  </div>
  <div class="input-group mb-3">
    <input type="text" class="form-control" placeholder="Flag" aria-label="Flag" aria-describedby="button-addon2" id="form-flag">
    <button class="btn btn-outline-primary" type="button" id="btn-verify">確認</button>
  </div>
  <script>
  // Generate sha256 hash.
  async function sha256(str) {
    const buff = new Uint8Array([].map.call(str, (c) => c.charCodeAt(0))).buffer;
    const digest = await window.crypto.subtle.digest('SHA-256', buff);
    return [].map.call(new Uint8Array(digest), x => ('00' + x.toString(16)).slice(-2)).join('');
}

  let button = document.getElementById('btn-verify');
  function verify_flag(){
    let flag = document.getElementById('form-flag').value;
    sha256(flag).then(result => {
      if(result == "575afa6d260c6d6cf9dc961221ee3631a487dd08651c1a4663ba0f1f990a8200") {
        button.innerHTML = "正解";
        button.classList.remove("btn-outline-primary", "btn-outline-danger");
        button.classList.add("btn-outline-success");
      } else {
        button.innerHTML = "不正解";
        button.classList.remove("btn-outline-primary", "btn-outline-success");
        button.className = "btn btn-outline-danger";
      }
    })
  }

  button.addEventListener('click', verify_flag());
  </script>
    </div>
  </body>
</html>
